<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Medicine Bill</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            background: #f4f6f9;
        }
        .bill-card {
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .table thead {
            background-color: #198754;
            color: white;
        }
        .esewa-btn {
            background-color: #60bb46;
            border: none;
        }
        .esewa-btn:hover {
            background-color: #4aa333;
        }
    </style>
</head>
<body>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">

            <div class="card bill-card">
                <div class="card-header bg-white border-0 text-center">
                    <h4 class="fw-bold mb-0">
                        <i class="bi bi-receipt"></i> Medicine Bill Details
                    </h4>
                    <small class="text-muted">Pharmacy Invoice</small>
                </div>

                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>Medicine</th>
                                    <th class="text-end">Rate (Rs)</th>
                                    <th class="text-center">Qty</th>
                                    <th class="text-end">Total Amt (Rs)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="medicine : ${record.getMedicines()}">
                                    <td th:text="${medicine.getMedicineName()}"></td>
                                    <td class="text-end" th:text="${medicine.getRate()}"></td>
                                    <td class="text-center" th:text="${medicine.getQuantity()}"></td>
                                    <td class="text-end" th:text="${medicine.getTotalAmt()}"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <hr>

                    <div class="row">
                        <div class="col-md-6">
                            <p class="mb-0"><strong>Date: </strong><span th:text="${record.getPurchaseDateTime().toString().substring(0,10)}"></span></p>
                        </div>
                        <div class="col-md-6 text-end">
                            <h5>Total Amount</h5>
                            <h3 class="text-success fw-bold">Rs. <span th:text="${record.getTotalAmt()}"></span></h3>
                        </div>
                    </div>
                </div>

                <div class="card-footer bg-white border-0">
                    <div class="d-grid">
                        <form action="https://rc-epay.esewa.com.np/api/epay/main/v2/form" method="POST">
                            <input type="hidden" id="amount" name="amount" th:value="${record.getTotalAmt()}" required>
                            <input type="hidden" id="tax_amount" name="tax_amount" value ="0" required>
                            <input type="hidden" id="total_amount" name="total_amount" th:value="${record.getTotalAmt()}" required>
                            <input type="hidden" id="transaction_uuid" name="transaction_uuid" th:value="${record.getTransactionId()}" required>
                            <input type="hidden" id="product_code" name="product_code" th:value="${productCode}" required>
                            <input type="hidden" id="product_service_charge" name="product_service_charge" value="0" required>
                            <input type="hidden" id="product_delivery_charge" name="product_delivery_charge" value="0" required>
                            <input type="hidden" id="success_url" name="success_url" th:value="${successRedirectUrl}" required>
                            <input type="hidden" id="failure_url" name="failure_url" th:value="${failureRedirectUrl}" required>
                            <input type="hidden" id="Signed_field_names" name="signed_field_names" th:value="${signedFieldNames}" required>
                            <input type="hidden" id="signature" name="signature" th:value="${signature}" required>
                            <button class="btn esewa-btn btn-lg text-white" type="submit">
                                <i class="bi bi-wallet2"></i> Pay via eSewa
                            </button>
                        </form>
                    </div>
                    <small class="text-muted d-block text-center mt-2">
                        Secure payment powered by eSewa
                    </small>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
