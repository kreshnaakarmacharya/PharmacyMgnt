<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Checkout</title>

    <!-- Bootstrap CSS (if not already included) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<!-- ======================= ADD ADDRESS TOP BAR ======================= -->
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3>Checkout</h3>

        <!-- If shippingDetails is null, show Add Address button -->
        <div th:if="${shippingDetails == null}">
            <a href="/addShippingAddress" class="btn btn-primary">+ Add Address</a>
        </div>

        <!-- If shippingDetails exists, show the shipping info -->
        <div th:if="${shippingDetails != null}">
            <p>
                <strong th:text="${shippingDetails.recipientName}"></strong><br>
                <span th:text="${shippingDetails.recipientPhoneNumber}"></span><br>
                <span th:text="${shippingDetails.address}"></span>
            </p>
            <!-- Optional: Edit button -->
            <a href="/addShippingAddress" class="btn btn-secondary btn-sm">Edit</a>
        </div>
    </div>

    <!-- ======================= DELIVERY NOTE ======================= -->
    <div class="alert alert-info fw-semibold">
        ðŸšš Delivery within <strong>1â€“5 days</strong> depending on your location.
    </div>

    <div th:if="${!#lists.isEmpty(cartItems)}">

        <!-- ======================= CART TABLE ======================= -->
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title mb-3">Your Products</h5>

                <table class="table table-bordered table-hover align-middle">
                    <thead class="table-dark">
                    <tr>
                        <th>S.N</th>
                        <th>Image</th>
                        <th>Name</th>
                        <th>Price (Rs.)</th>
                        <th>Quantity</th>
                        <th>Total (Rs.)</th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="item, iter : ${cartItems}">
                        <td th:text="${iter.count}"></td>
                        <td><img th:src="@{${item.medicine.imageUrl}}" width="70" height="70" class="rounded"></td>
                        <td th:text="${item.medicine.name}"></td>
                        <td th:text="${item.medicine.price}"></td>
                        <td th:text="${item.quantity}"></td>
                        <td th:text="${item.totalPrice}"></td>
                    </tr>
                    </tbody>
                </table>

                <!-- ======================= SUMMARY SECTION ======================= -->
                <div class="mt-4">
                    <h5>Order Summary</h5>
                    <hr>

                    <div class="d-flex justify-content-between">
                        <span>Total Product Amount:</span>
                        <strong><span th:text="${productTotal}"></span> Rs</strong>
                    </div>

                    <div class="d-flex justify-content-between mt-2">
                        <span>Delivery Charge:</span>
                        <strong><span th:text="${deliveryCharge}"></span> Rs</strong>
                    </div>

                    <hr>

                    <div class="d-flex justify-content-between fs-5">
                        <span>Grand Total:</span>
                        <strong class="text-success">
                            <span th:text="${grandTotal}"></span> Rs
                        </strong>
                    </div>
                </div>

                <!-- ======================= ACTION BUTTONS ======================= -->
                <div class="d-flex justify-content-end mt-4">
                    <form action="/placeOrder" method="post">
                        <button type="submit" class="btn btn-success me-2">Place Order</button>
                    </form>

                </div>

            </div>
        </div>

    </div>
</div>

</body>
</html>
